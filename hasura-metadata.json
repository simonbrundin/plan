{
  "version": 2,
  "sources": [
    {
      "name": "default",
      "kind": "postgres",
      "tables": [
        {
          "table": {
            "name": "goals",
            "schema": "public"
          },
          "select_permissions": [
            {
              "role": "user",
              "permission": {
                "columns": ["id", "title", "created", "finished"],
                "filter": {
                  "user_goals": {
                    "user_id": {
                      "_eq": "X-Hasura-User-Id"
                    }
                  }
                },
                "allow_aggregations": true
              }
            },
            {
              "role": "admin",
              "permission": {
                "columns": ["id", "title", "created", "finished"],
                "filter": {},
                "allow_aggregations": true
              }
            }
          ]
        },
        {
          "table": {
            "name": "user_goals",
            "schema": "public"
          },
          "select_permissions": [
            {
              "role": "user",
              "permission": {
                "columns": ["user_id", "goal_id"],
                "filter": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                },
                "allow_aggregations": true
              }
            },
            {
              "role": "admin",
              "permission": {
                "columns": ["user_id", "goal_id"],
                "filter": {},
                "allow_aggregations": true
              }
            }
          ]
        },
        {
          "table": {
            "name": "goal_relations",
            "schema": "public"
          },
          "select_permissions": [
            {
              "role": "user",
              "permission": {
                "columns": ["parent_id", "child_id"],
                "filter": {
                  "_or": [
                    {
                      "parent_id": {
                        "_in": "select goal_id from user_goals where user_id = X-Hasura-User-Id"
                      }
                    },
                    {
                      "child_id": {
                        "_in": "select goal_id from user_goals where user_id = X-Hasura-User-Id"
                      }
                    }
                  ]
                },
                "allow_aggregations": true
              }
            },
            {
              "role": "admin",
              "permission": {
                "columns": ["parent_id", "child_id"],
                "filter": {},
                "allow_aggregations": true
              }
            }
          ]
        }
      ],
      "configuration": {
        "connection_info": {
          "database_url": {
            "from_env": "HASURA_GRAPHQL_DATABASE_URL"
          },
          "pool_settings": {
            "max_connections": 50,
            "idle_timeout": 180,
            "retries": 1
          }
        }
      }
    }
  ]
}